{
  "version": 3,
  "sources": ["../../src/lib/apiHelper.ts"],
  "sourcesContent": ["import axios from \"axios\";\r\nimport crypto from \"crypto\";\r\nconst API_BASE_URL = \"https://www.soliscloud.com:13333\";\r\n\r\nexport async function getStationDetails(stationId: string, apiKey: string, apiSecret: string) {\r\n    const map = {\r\n        id: stationId,\r\n    };\r\n    const body = JSON.stringify(map);\r\n    const ContentMd5 = getDigest(body);\r\n    const currentDate = getGMTTime();\r\n    const param =\r\n        \"POST\" +\r\n        \"\\n\" +\r\n        ContentMd5 +\r\n        \"\\n\" +\r\n        \"application/json\" +\r\n        \"\\n\" +\r\n        currentDate +\r\n        \"\\n\" +\r\n        \"/v1/api/stationDetail\";\r\n    const sign = HmacSHA1Encrypt(param, apiSecret);\r\n    const url = API_BASE_URL + \"/v1/api/stationDetail\";\r\n    try {\r\n        const requestBody = JSON.stringify(map);\r\n        const response = await axios({\r\n            method: \"post\",\r\n            url: url,\r\n            headers: {\r\n                \"Content-type\": \"application/json;charset=UTF-8\",\r\n                Authorization: `API ${apiKey}:${sign}`,\r\n                \"Content-MD5\": ContentMd5,\r\n                Date: currentDate,\r\n            },\r\n            data: requestBody,\r\n        });\r\n        //console.log(response.data.data);\r\n        return {\r\n            current_Power: response.data.data.power,\r\n            current_consumption: response.data.data.familyLoadPower,\r\n            current_From_Net: response.data.data.psum,\r\n            sold_Today: response.data.data.gridSellDayEnergy,\r\n            generated_Today: response.data.data.dayEnergy,\r\n            bought_Today: response.data.data.gridPurchasedDayEnergy,\r\n            consumption_Today: response.data.data.homeLoadEnergy,\r\n            battery_percent: response.data.data.batteryPercent,\r\n            battery_current_usage: response.data.data.batteryPower,\r\n        };\r\n    } catch (error) {\r\n        console.error(error);\r\n    }\r\n}\r\n\r\nexport function HmacSHA1Encrypt(encryptText: string, keySecret: string):string {\r\n    const keyBuffer = Buffer.from(keySecret, \"utf-8\");\r\n    const hmac = crypto.createHmac(\"sha1\", keyBuffer);\r\n    hmac.update(encryptText, \"utf-8\");\r\n    const resultBuffer = hmac.digest();\r\n    return resultBuffer.toString(\"base64\");\r\n}\r\n\r\nexport function getGMTTime():string {\r\n    const cd = new Date();\r\n    const days = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\n    const months = [\r\n        \"Jan\",\r\n        \"Feb\",\r\n        \"Mar\",\r\n        \"Apr\",\r\n        \"May\",\r\n        \"Jun\",\r\n        \"Jul\",\r\n        \"Aug\",\r\n        \"Sep\",\r\n        \"Oct\",\r\n        \"Nov\",\r\n        \"Dec\",\r\n    ];\r\n\r\n    return `${days[cd.getUTCDay()]}, ${cd.getUTCDate()} ${months[cd.getUTCMonth()]} ${cd.getUTCFullYear()} ${cd.getUTCHours()}:${cd.getUTCMinutes()}:${cd.getUTCSeconds()} GMT`;\r\n}\r\n\r\nexport function getDigest(test:string):string {\r\n    const md5 = crypto.createHash(\"md5\");\r\n    md5.update(test);\r\n    return md5.digest(\"base64\");\r\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAkB;AAClB,oBAAmB;AACnB,MAAM,eAAe;AAErB,eAAsB,kBAAkB,WAAmB,QAAgB,WAAmB;AAC1F,QAAM,MAAM;AAAA,IACR,IAAI;AAAA,EACR;AACA,QAAM,OAAO,KAAK,UAAU,GAAG;AAC/B,QAAM,aAAa,UAAU,IAAI;AACjC,QAAM,cAAc,WAAW;AAC/B,QAAM,QACF,WAEA,aACA,yBAGA,cACA;AAEJ,QAAM,OAAO,gBAAgB,OAAO,SAAS;AAC7C,QAAM,MAAM,eAAe;AAC3B,MAAI;AACA,UAAM,cAAc,KAAK,UAAU,GAAG;AACtC,UAAM,WAAW,UAAM,aAAAA,SAAM;AAAA,MACzB,QAAQ;AAAA,MACR;AAAA,MACA,SAAS;AAAA,QACL,gBAAgB;AAAA,QAChB,eAAe,OAAO,UAAU;AAAA,QAChC,eAAe;AAAA,QACf,MAAM;AAAA,MACV;AAAA,MACA,MAAM;AAAA,IACV,CAAC;AAED,WAAO;AAAA,MACH,eAAe,SAAS,KAAK,KAAK;AAAA,MAClC,qBAAqB,SAAS,KAAK,KAAK;AAAA,MACxC,kBAAkB,SAAS,KAAK,KAAK;AAAA,MACrC,YAAY,SAAS,KAAK,KAAK;AAAA,MAC/B,iBAAiB,SAAS,KAAK,KAAK;AAAA,MACpC,cAAc,SAAS,KAAK,KAAK;AAAA,MACjC,mBAAmB,SAAS,KAAK,KAAK;AAAA,MACtC,iBAAiB,SAAS,KAAK,KAAK;AAAA,MACpC,uBAAuB,SAAS,KAAK,KAAK;AAAA,IAC9C;AAAA,EACJ,SAAS,OAAP;AACE,YAAQ,MAAM,KAAK;AAAA,EACvB;AACJ;AAEO,SAAS,gBAAgB,aAAqB,WAA0B;AAC3E,QAAM,YAAY,OAAO,KAAK,WAAW,OAAO;AAChD,QAAM,OAAO,cAAAC,QAAO,WAAW,QAAQ,SAAS;AAChD,OAAK,OAAO,aAAa,OAAO;AAChC,QAAM,eAAe,KAAK,OAAO;AACjC,SAAO,aAAa,SAAS,QAAQ;AACzC;AAEO,SAAS,aAAoB;AAChC,QAAM,KAAK,IAAI,KAAK;AACpB,QAAM,OAAO,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAK;AAC7D,QAAM,SAAS;AAAA,IACX;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACJ;AAEA,SAAO,GAAG,KAAK,GAAG,UAAU,OAAO,GAAG,WAAW,KAAK,OAAO,GAAG,YAAY,MAAM,GAAG,eAAe,KAAK,GAAG,YAAY,KAAK,GAAG,cAAc,KAAK,GAAG,cAAc;AACxK;AAEO,SAAS,UAAU,MAAoB;AAC1C,QAAM,MAAM,cAAAA,QAAO,WAAW,KAAK;AACnC,MAAI,OAAO,IAAI;AACf,SAAO,IAAI,OAAO,QAAQ;AAC9B;",
  "names": ["axios", "crypto"]
}
